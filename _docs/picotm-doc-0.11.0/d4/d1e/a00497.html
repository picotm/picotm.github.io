<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>picotm: The picotm Programming Interface</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">The picotm Programming Interface</div>  </div>
</div><!--header-->
<div class="contents">

<p>This section provides information for users of picotm. It explains the concept of transactions and how to run a transaction with picotm.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:d4/dee/a00008"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dee/a00008.html">picotm-error.h</a></td></tr>
<tr class="memdesc:d4/dee/a00008"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains struct <a class="el" href="../../d4/dfb/a00512.html">picotm_error</a> and helper functions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d7/db6/a00940"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/db6/a00940.html">picotm.h</a></td></tr>
<tr class="memdesc:d7/db6/a00940"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main header file for picotm. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h1><a class="anchor" id="lib_properties_of_a_transaction"></a>
Properties of a Transaction</h1>
<p>The transaction concept is a powerful metaphor for implementing concurrent and fault-tolerant software. A transaction system provides two services to it's users. These are</p>
<ul>
<li>concurrency control (i.e., thread-safe access to shared resources), and</li>
<li>error handling.</li>
</ul>
<h1><a class="anchor" id="lib_writing_transactions"></a>
Writing Transactions</h1>
<p>Each transactions contains at least the statements</p>
<ol type="1">
<li><a class="el" href="../../d7/db6/a00940.html#acc4de35068696187a89ba73ff54f2c82">picotm_begin</a>,</li>
<li><a class="el" href="../../d7/db6/a00940.html#aa2a3ff1fd64dd3038cb3e863da12f1c9">picotm_commit</a>, and</li>
<li><a class="el" href="../../d7/db6/a00940.html#acc10340471b96a797fbf6610341bbe01">picotm_end</a></li>
</ol>
<p>in this exact order. In the source code, this looks like this</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span></div><div class="line">func()</div><div class="line">{</div><div class="line">     <span class="comment">// non-transactional code</span></div><div class="line"></div><div class="line">     <span class="keywordtype">int</span> x = 0;</div><div class="line"></div><div class="line">     <a class="code" href="../../d7/db6/a00940.html#acc4de35068696187a89ba73ff54f2c82">picotm_begin</a></div><div class="line">         <span class="comment">// transactional code</span></div><div class="line">     <a class="code" href="../../d7/db6/a00940.html#aa2a3ff1fd64dd3038cb3e863da12f1c9">picotm_commit</a></div><div class="line">     <a class="code" href="../../d7/db6/a00940.html#acc10340471b96a797fbf6610341bbe01">picotm_end</a></div><div class="line"></div><div class="line">     <span class="comment">// more non-transactional code</span></div><div class="line">}</div></div><!-- fragment --><p>Transactional operations are invoked between <a class="el" href="../../d7/db6/a00940.html#acc4de35068696187a89ba73ff54f2c82">picotm_begin</a> and <a class="el" href="../../d7/db6/a00940.html#aa2a3ff1fd64dd3038cb3e863da12f1c9">picotm_commit</a>. This is called the transaction's <em>execution phase.</em> Operations listed in the execution phase are subject to speculative execution. This means that an operation might be executed, but it's effects are not be permanent until the transaction commits.</p>
<p>The transaction performs a commit when the user invokes <a class="el" href="../../d7/db6/a00940.html#aa2a3ff1fd64dd3038cb3e863da12f1c9">picotm_commit</a>. This is called the <em>commit phase.</em> It is completely implemented by picotm. No intervention by the user is required.</p>
<p>Upon entering the commit phase, picotm validates the consistency of all resources that the transaction uses. If validation succeeds, the transaction's effects are applied to become permanent. The program then continuous with the next operation after <a class="el" href="../../d7/db6/a00940.html#acc10340471b96a797fbf6610341bbe01">picotm_end</a>. If validation fails, the transaction's effects are reverted and the transaction restarts from <a class="el" href="../../d7/db6/a00940.html#acc4de35068696187a89ba73ff54f2c82">picotm_begin</a>. The roll-back is transparent to the program.</p>
<p>If an operation fails, picotm provides error handling for it's operations. Error handling consists of</p>
<ul>
<li>error detection, and</li>
<li>error recovery.</li>
</ul>
<p>Error detection is completely implemented by picotm an it's module. When picotm invokes an operation it tests for reported errors. No intervention by the user is required.</p>
<p>Error recovery is partially provided by picotm. For picotm, it is possible to recover from some errors. For example, if a write operation to a file temporarily fails, picotm can retry.</p>
<p>Some errors require special program logic to recover. For example, if the program runs out of memory, it might free up memory by invoking a garbage collector. This cannot generally be implemented by picotm, as it depends on program-specific constraints. This is called the <em>recovery phase.</em></p>
<p>Error-recovery code is located between <a class="el" href="../../d7/db6/a00940.html#aa2a3ff1fd64dd3038cb3e863da12f1c9">picotm_commit</a> and <a class="el" href="../../d7/db6/a00940.html#acc10340471b96a797fbf6610341bbe01">picotm_end</a>. If picotm detects an error that is cannot recover from, it rolls back the transaction's effects and jumps to the first instruction <em>after</em> <a class="el" href="../../d7/db6/a00940.html#aa2a3ff1fd64dd3038cb3e863da12f1c9">picotm_commit</a>. The program now has the chance of performing error recovery and, if successful, restart the transaction by calling <a class="el" href="../../d7/db6/a00940.html#ad4caaf20fc37108f33c8c08bf8ea1d51">picotm_restart()</a>. </p>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!--
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
-->
</body>
</html>
